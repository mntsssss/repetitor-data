<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>—á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞—Ç—å –∏ —Å—á–∏—Ç–∞—Ç—å –¥–µ–Ω—å–≥–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 1400px;
            padding: 30px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ª–æ–≥–∏–Ω–∞ */
        .login-container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }

        .login-container h2 {
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
        }

        .login-btn:hover {
            transform: translateY(-2px);
        }

        .error-message {
            color: #e74c3c;
            margin-top: 15px;
            font-size: 14px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .header h1 {
            color: #333;
            font-size: 28px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .username-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
        }

        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }

        .logout-btn:hover {
            background: #c0392b;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 25px;
            background: #f8f9fa;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #555;
            transition: all 0.3s;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading-spinner {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* –°—Ç–∞—Ç—É—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */
        .save-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            display: none;
            animation: slideIn 0.3s;
            z-index: 999;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü */
        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            padding: 15px;
            text-align: center;
            font-size: 14px;
        }

        td {
            border: 1px solid #e0e0e0;
            padding: 10px;
            text-align: center;
            min-width: 80px;
        }

        .time-col {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        .editable-cell {
            cursor: pointer;
            position: relative;
        }

        .editable-cell:hover {
            background: #f0f3ff;
        }

        .editable-cell input {
            width: 100%;
            padding: 5px;
            border: 2px solid #667eea;
            border-radius: 5px;
            font-size: 14px;
        }

        /* –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–≤–æ–∫ */
        .rates-table th {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .rates-table td {
            text-align: left;
        }

        .rates-table td input {
            width: 100%;
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            font-size: 14px;
        }

        .rates-table td input:focus {
            outline: none;
            border-color: #2ecc71;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn-group {
            display: flex;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.4);
        }

        .btn-info {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .btn-info:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        /* –û—Ç—á–µ—Ç */
        .report-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-top: 20px;
        }

        .report-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .report-content {
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            line-height: 1.6;
            color: #333;
        }

        .total-income {
            font-size: 18px;
            font-weight: 600;
            color: #27ae60;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        /* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è */
        .instruction {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            color: #856404;
        }

        .instruction h3 {
            margin-bottom: 10px;
        }

        .instruction ul {
            margin-left: 20px;
        }

        .instruction li {
            margin: 5px 0;
        }

        /* GitHub –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
        .github-settings {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .github-settings h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .github-settings input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }

        .github-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }

        .github-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .github-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <!-- –õ–æ–≥–∏–Ω -->
        <div id="login-section" class="login-container">
            <h2>üìö –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–∞</h2>
            <div class="input-group">
                <label>üë§ –õ–æ–≥–∏–Ω</label>
                <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω" value="mntsss">
            </div>
            <div class="input-group">
                <label>üîê –ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" value="12345">
            </div>
            <button class="login-btn" onclick="login()">–í–æ–π—Ç–∏</button>
            <div id="login-error" class="error-message"></div>
            
            <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                <p><strong>üë• –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏:</strong></p>
                <p>‚Ä¢ mntsss / 12345</p>
                <p>‚Ä¢ masha / 12345</p>
                <p style="font-size: 12px; color: #666; margin-top: 10px;">–£ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ</p>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (—Å–∫—Ä—ã—Ç –¥–æ –ª–æ–≥–∏–Ω–∞) -->
        <div id="main-section" style="display: none;">
            <div class="header">
                <h1>üìö –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–∞</h1>
                <div class="user-info">
                    <span class="username-badge" id="current-username"></span>
                    <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∏ -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('schedule')">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
                <button class="tab" onclick="switchTab('rates')">üí∞ –°—Ç–∞–≤–∫–∏</button>
                <button class="tab" onclick="switchTab('report')">üìä –û—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é</button>
            </div>

            <!-- GitHub –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–∫—Ä—ã—Ç—ã, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) -->
            <div class="github-settings" id="github-settings" style="display: none;">
                <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)</h3>
                <input type="text" id="github-token" placeholder="GitHub Token">
                <input type="text" id="github-repo" placeholder="username/repo" value="mntsss/repetitor-data">
                <button class="btn btn-info" onclick="saveGitHubSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <div id="github-status" class="github-status"></div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º -->
            <div id="schedule-tab" class="tab-content active">
                <div class="instruction">
                    <h3>üìù –ö–∞–∫ –∑–∞–ø–æ–ª–Ω—è—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:</h3>
                    <ul>
                        <li>–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —è—á–µ–π–∫—É, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —É—á–µ–Ω–∏–∫–∞</li>
                        <li>–§–æ—Ä–º–∞—Ç: –ò–º—è –§–∞–º–∏–ª–∏—è –ö–ª–∞—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ 9")</li>
                        <li>–ü—É—Å—Ç–∞—è —è—á–µ–π–∫–∞ = –Ω–µ—Ç —É—Ä–æ–∫–∞</li>
                        <li>–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ GitHub</li>
                    </ul>
                </div>

                <div class="table-container" id="schedule-table"></div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="saveSchedule()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub</button>
                    <button class="btn btn-success" onclick="loadFromGitHub()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub</button>
                    <button class="btn btn-warning" onclick="resetSchedule()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ —Å–æ —Å—Ç–∞–≤–∫–∞–º–∏ -->
            <div id="rates-tab" class="tab-content">
                <div class="instruction">
                    <h3>üí∞ –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–≤–æ–∫ (—Ñ–æ—Ä–º–∞—Ç: —Å—Ç–∞–≤–∫–∞ | —É—á–µ–Ω–∏–∫ | –≤—Ä–µ–º—è | –¥–µ–Ω—å):</h3>
                    <ul>
                        <li>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ –Ω–∏–∂–µ</li>
                        <li>–°—Ç–∞–≤–∫–∞ - —Ü–∏—Ñ—Ä–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1500)</li>
                        <li>–î–µ–Ω—å - –ø–Ω, –≤—Ç, —Å—Ä, —á—Ç, –ø—Ç, —Å–±, –≤—Å</li>
                        <li>–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ GitHub</li>
                    </ul>
                </div>

                <div class="table-container">
                    <table class="rates-table" id="rates-table">
                        <thead>
                            <tr>
                                <th>–°—Ç–∞–≤–∫–∞ (‚ÇΩ)</th>
                                <th>–£—á–µ–Ω–∏–∫</th>
                                <th>–í—Ä–µ–º—è</th>
                                <th>–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="rates-body"></tbody>
                    </table>
                </div>

                <div class="btn-group">
                    <button class="btn btn-success" onclick="addRateRow()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
                    <button class="btn btn-primary" onclick="saveRates()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub</button>
                    <button class="btn btn-info" onclick="loadRatesFromGitHub()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub</button>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ —Å –æ—Ç—á–µ—Ç–æ–º -->
            <div id="report-tab" class="tab-content">
                <div class="instruction">
                    <h3>üìä –û—Ç—á–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø–æ –¥–∞–Ω–Ω—ã–º –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–≤–æ–∫</h3>
                    <p>–ù–µ–¥–µ–ª—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å –ø—è—Ç–Ω–∏—Ü—ã –ø–æ —á–µ—Ç–≤–µ—Ä–≥</p>
                </div>

                <div class="btn-group">
                    <button class="btn btn-success" onclick="generateReport()">üìä –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç</button>
                    <button class="btn btn-primary" onclick="copyReport()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>

                <div class="report-container" id="report-container" style="display: none;">
                    <div class="report-title">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é</div>
                    <div class="report-content" id="report-content"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading-overlay" id="loading">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div id="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
    </div>

    <!-- –°—Ç–∞—Ç—É—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
    <div class="save-status" id="save-status">‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!</div>

    <script>
        // ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========
        const USERS = {
            'mntsss': '12345',
            'masha': '12345'
        };

        // –î–Ω–∏ –Ω–µ–¥–µ–ª–∏ –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        const DAYS = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'];
        
        // –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã
        const TIME_SLOTS = [
            '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', 
            '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00'
        ];

        // –°–æ–∫—Ä–∞—â–µ–Ω–∏—è –¥–Ω–µ–π –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–≤–æ–∫
        const DAY_SHORTS = {
            '–ø–Ω': '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫',
            '–≤—Ç': '–í—Ç–æ—Ä–Ω–∏–∫',
            '—Å—Ä': '–°—Ä–µ–¥–∞',
            '—á—Ç': '–ß–µ—Ç–≤–µ—Ä–≥',
            '–ø—Ç': '–ü—è—Ç–Ω–∏—Ü–∞',
            '—Å–±': '–°—É–±–±–æ—Ç–∞',
            '–≤—Å': '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'
        };

        // ========== –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ==========
        let currentUser = null;
        let scheduleData = {};
        let ratesData = [];

        // GitHub –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω)
        const GITHUB_CONFIG = {
            token: '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', // –í–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å Personal Access Token –Ω–∞ GitHub
            repo: 'mntsssss/repetitor-data', // –í–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
            branch: 'main'
        };

        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–ì–†–£–ó–ö–û–ô ==========
        function showLoading(message = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
            document.getElementById('loading').style.display = 'flex';
            document.getElementById('loading-text').textContent = message;
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function showSaveStatus(message = '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!') {
            const status = document.getElementById('save-status');
            status.textContent = message;
            status.style.display = 'block';
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        function init() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser && USERS[savedUser]) {
                currentUser = savedUser;
                document.getElementById('current-username').textContent = currentUser;
                showMainSection();
                loadFromGitHub(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ GitHub –ø—Ä–∏ –≤—Ö–æ–¥–µ
            }
        }

        // ========== –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ==========
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const errorDiv = document.getElementById('login-error');

            if (USERS[username] && USERS[username] === password) {
                currentUser = username;
                localStorage.setItem('currentUser', username);
                document.getElementById('current-username').textContent = currentUser;
                errorDiv.textContent = '';
                showMainSection();
                loadFromGitHub(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            } else {
                errorDiv.textContent = '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('main-section').style.display = 'none';
            document.getElementById('login-section').style.display = 'block';
            document.getElementById('username').value = 'mntsss';
            document.getElementById('password').value = '12345';
        }

        function showMainSection() {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('main-section').style.display = 'block';
        }

        // ========== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –í–ö–õ–ê–î–û–ö ==========
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tabName === 'schedule') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('schedule-tab').classList.add('active');
                renderSchedule();
            } else if (tabName === 'rates') {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('rates-tab').classList.add('active');
                renderRates();
            } else if (tabName === 'report') {
                document.querySelectorAll('.tab')[2].classList.add('active');
                document.getElementById('report-tab').classList.add('active');
            }
        }

        // ========== –†–ê–ë–û–¢–ê –° GITHUB ==========
        async function saveToGitHub(filename, data) {
            if (!currentUser) return;
            
            showLoading(`–°–æ—Ö—Ä–∞–Ω—è—é ${filename}...`);
            
            try {
                // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const userFilename = `${currentUser}/${filename}`;
                
                // –ö–æ–¥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ base64
                const content = btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2))));
                
                // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª (—á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å sha)
                let sha = null;
                try {
                    const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${userFilename}`, {
                        headers: {
                            'Authorization': `token ${GITHUB_CONFIG.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (response.ok) {
                        const fileData = await response.json();
                        sha = fileData.sha;
                    }
                } catch (e) {
                    console.log('–§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π');
                }
                
                // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Ñ–∞–π–ª
                const commitData = {
                    message: `–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${currentUser}`,
                    content: content,
                    branch: GITHUB_CONFIG.branch
                };
                
                if (sha) {
                    commitData.sha = sha;
                }
                
                const saveResponse = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${userFilename}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Content-Type': 'application/json',
                        'Accept': 'application/vnd.github.v3+json'
                    },
                    body: JSON.stringify(commitData)
                });
                
                if (saveResponse.ok) {
                    showSaveStatus(`‚úÖ ${filename} —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ GitHub`);
                } else {
                    const error = await saveResponse.json();
                    throw new Error(error.message);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ GitHub:', error);
                alert(`‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${error.message}\n\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub —Ç–æ–∫–µ–Ω–∞.`);
            } finally {
                hideLoading();
            }
        }

        async function loadFromGitHub() {
            if (!currentUser) return;
            
            showLoading('–ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ...');
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                await loadScheduleFromGitHub();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞–≤–∫–∏
                await loadRatesFromGitHub();
                
                hideLoading();
                showSaveStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ GitHub');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                hideLoading();
                
                // –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—ã–µ
                if (error.message.includes('404')) {
                    createDefaultSchedule();
                    ratesData = [];
                    renderSchedule();
                    renderRates();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`);
                }
            }
        }

        async function loadScheduleFromGitHub() {
            if (!currentUser) return;
            
            try {
                const userFilename = `${currentUser}/schedule.json`;
                const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${userFilename}`, {
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const content = decodeURIComponent(escape(atob(data.content)));
                    scheduleData = JSON.parse(content);
                    renderSchedule();
                } else if (response.status === 404) {
                    createDefaultSchedule();
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:', error);
                createDefaultSchedule();
            }
        }

        async function loadRatesFromGitHub() {
            if (!currentUser) return;
            
            try {
                const userFilename = `${currentUser}/rates.json`;
                const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${userFilename}`, {
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const content = decodeURIComponent(escape(atob(data.content)));
                    ratesData = JSON.parse(content);
                    renderRates();
                } else if (response.status === 404) {
                    ratesData = [];
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫:', error);
                ratesData = [];
            }
        }

        // ========== –†–ê–ë–û–¢–ê –° –†–ê–°–ü–ò–°–ê–ù–ò–ï–ú ==========
        function createDefaultSchedule() {
            scheduleData = {};
            DAYS.forEach(day => {
                scheduleData[day] = {};
                TIME_SLOTS.forEach(time => {
                    scheduleData[day][time] = '';
                });
            });
            renderSchedule();
        }

        function renderSchedule() {
            const table = document.getElementById('schedule-table');
            
            let html = '<table><thead><tr><th>–î–µ–Ω—å / –í—Ä–µ–º—è</th>';
            
            TIME_SLOTS.forEach(time => {
                html += `<th>${time}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            DAYS.forEach(day => {
                html += '<tr>';
                html += `<td class="time-col"><strong>${day}</strong></td>`;
                
                TIME_SLOTS.forEach(time => {
                    const value = scheduleData[day]?.[time] || '';
                    html += `<td class="editable-cell" onclick="editCell('${day}', '${time}', this)">${value}</td>`;
                });
                
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            table.innerHTML = html;
        }

        function editCell(day, time, cell) {
            const currentValue = cell.innerText;
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentValue;
            input.style.width = '100%';
            
            input.onblur = function() {
                const newValue = this.value.trim();
                scheduleData[day][time] = newValue;
                cell.innerText = newValue;
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    this.blur();
                }
            };
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
        }

        async function saveSchedule() {
            await saveToGitHub('schedule.json', scheduleData);
        }

        function resetSchedule() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è?')) {
                createDefaultSchedule();
            }
        }

        // ========== –†–ê–ë–û–¢–ê –°–û –°–¢–ê–í–ö–ê–ú–ò ==========
        function renderRates() {
            const tbody = document.getElementById('rates-body');
            
            if (!ratesData || ratesData.length === 0) {
                ratesData = [
                    { rate: '', student: '', time: '', day: '' }
                ];
            }
            
            let html = '';
            ratesData.forEach((row, index) => {
                html += '<tr>';
                html += `<td><input type="number" value="${row.rate || ''}" placeholder="–°—Ç–∞–≤–∫–∞" onchange="updateRate(${index}, 'rate', this.value)"></td>`;
                html += `<td><input type="text" value="${row.student || ''}" placeholder="–£—á–µ–Ω–∏–∫" onchange="updateRate(${index}, 'student', this.value)"></td>`;
                html += `<td><input type="text" value="${row.time || ''}" placeholder="–í—Ä–µ–º—è (14:00)" onchange="updateRate(${index}, 'time', this.value)"></td>`;
                html += `<td><input type="text" value="${row.day || ''}" placeholder="–î–µ–Ω—å (–ø–Ω, –≤—Ç...)" onchange="updateRate(${index}, 'day', this.value)"></td>`;
                html += `<td><button onclick="deleteRateRow(${index})" style="background:#e74c3c; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;">üóë</button></td>`;
                html += '</tr>';
            });
            
            tbody.innerHTML = html;
        }

        function updateRate(index, field, value) {
            ratesData[index][field] = value;
        }

        function addRateRow() {
            ratesData.push({ rate: '', student: '', time: '', day: '' });
            renderRates();
        }

        function deleteRateRow(index) {
            ratesData.splice(index, 1);
            if (ratesData.length === 0) {
                ratesData.push({ rate: '', student: '', time: '', day: '' });
            }
            renderRates();
        }

        async function saveRates() {
            await saveToGitHub('rates.json', ratesData);
        }

        // ========== –§–û–†–ú–ò–†–û–í–ê–ù–ò–ï –û–¢–ß–ï–¢–ê ==========
        function generateReport() {
            const reportContainer = document.getElementById('report-container');
            const reportContent = document.getElementById('report-content');
            
            const validLessons = ratesData.filter(lesson => 
                lesson.student && lesson.student.trim() && 
                lesson.day && lesson.day.trim() &&
                lesson.time && lesson.time.trim()
            );
            
            if (validLessons.length === 0) {
                alert('‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç—á–µ—Ç–∞. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å—Ç–∞–≤–æ–∫.');
                return;
            }
            
            const groupedByDay = {};
            const dayNames = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'];
            
            validLessons.forEach(lesson => {
                const dayShort = lesson.day.toLowerCase().trim();
                if (DAY_SHORTS[dayShort]) {
                    const dayFull = DAY_SHORTS[dayShort];
                    if (!groupedByDay[dayFull]) {
                        groupedByDay[dayFull] = [];
                    }
                    groupedByDay[dayFull].push(lesson);
                }
            });
            
            const today = new Date();
            
            // –ù–∞—Ö–æ–¥–∏–º –ø—è—Ç–Ω–∏—Ü—É
            let daysToFriday;
            if (today.getDay() === 5) { // –ø—è—Ç–Ω–∏—Ü–∞
                daysToFriday = 0;
            } else if (today.getDay() > 5) { // —Å–±, –≤—Å
                daysToFriday = today.getDay() - 5;
            } else { // –ø–Ω-—á—Ç
                daysToFriday = today.getDay() + 2;
            }
            
            const friday = new Date(today);
            friday.setDate(today.getDate() - daysToFriday);
            
            const weekDates = {};
            for (let i = 0; i < 7; i++) {
                const date = new Date(friday);
                date.setDate(friday.getDate() + i);
                const dayName = dayNames[date.getDay() === 0 ? 6 : date.getDay() - 1];
                weekDates[dayName] = date.toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit' });
            }
            
            let report = '';
            let totalIncome = 0;
            
            const reportDays = ['–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥'];
            
            reportDays.forEach(day => {
                const lessons = groupedByDay[day] || [];
                if (lessons.length === 0) return;
                
                const dateStr = weekDates[day] || '';
                report += `${dateStr} ${day}\n`;
                
                lessons.sort((a, b) => {
                    const timeA = a.time || '00:00';
                    const timeB = b.time || '00:00';
                    return timeA.localeCompare(timeB);
                });
                
                lessons.forEach(lesson => {
                    const rate = parseInt(lesson.rate) || 0;
                    report += `${lesson.time} ${lesson.student} - ${rate}—Ä\n`;
                    totalIncome += rate;
                });
                
                report += '\n';
            });
            
            report += `–û–±—â–∏–π –¥–æ—Ö–æ–¥ –∑–∞ –Ω–µ–¥–µ–ª—é: ${totalIncome}—Ä`;
            
            reportContent.textContent = report;
            reportContainer.style.display = 'block';
        }

        function copyReport() {
            const report = document.getElementById('report-content').textContent;
            if (!report) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Å—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ –æ—Ç—á–µ—Ç');
                return;
            }
            
            navigator.clipboard.writeText(report).then(() => {
                showSaveStatus('‚úÖ –û—Ç—á–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
            }).catch(() => {
                alert('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å');
            });
        }

        // ========== –ù–ê–°–¢–†–û–ô–ö–ò GITHUB ==========
        function saveGitHubSettings() {
            const token = document.getElementById('github-token').value;
            const repo = document.getElementById('github-repo').value;
            
            if (token && repo) {
                GITHUB_CONFIG.token = token;
                GITHUB_CONFIG.repo = repo;
                
                const status = document.getElementById('github-status');
                status.className = 'github-status success';
                status.textContent = '‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!';
                status.style.display = 'block';
                
                setTimeout(() => {
                    status.style.display = 'none';
                }, 3000);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = init;
    </script>
</body>
</html>
